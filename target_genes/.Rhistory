filter_at(df, vars(Ozone, Solar.R, Wind, Temp), ~. > quantile(., probs = 0.75))
library(TissueEnrich)
genes<-system.file("extdata", "inputGenes.txt", package = "TissueEnrich")
genes
inputGenes<-scan(genes,character())
head(inpIDMapper())
head(inputGenes)
gs<-GeneSet(geneIds=inputGenes,organism="Homo Sapiens",geneIdType=SymbolIdentifier())
gs
output<-teEnrichment(inputGenes = gs, rnaSeqDataset = "Mouse ENCODE")
output<-teEnrichment(inputGenes = gs, rnaSeqDataset = 3)
head(output)
setwd("/work/LAS/geetu-lab/arnstrm/mouse.trophoblast.smallRNAseq/target_genes")
library(TissueEnrich)
files <-
list.files(path = '.', pattern = ".*\\_targetGenes.csv$")
lst <-
setNames(lapply(files, read.csv),
tools::file_path_sans_ext(basename(files)))
gene.lsts <- lapply(lst, '[[', 1)
setwd("C:/Users/arun/OneDrive - Iowa State University/OrganizedDocuments/github/mouse.trophoblast.smallRNAseq/target_genes")
files <-
list.files(path = '.', pattern = ".*\\_targetGenes.csv$")
lst <-
setNames(lapply(files, read.csv),
tools::file_path_sans_ext(basename(files)))
gene.lsts <- lapply(lst, '[[', 1)
gene.lsts
names(gene.lsts)
?GeneSet
?teEnrichment
output
en.output <-
setNames(data.frame(assay(output[[1]]), row.names = rowData(output[[1]])[, 1]),
colData(output[[1]])[, 1])
en.output
en.output$Tissue <- rownames(en.output)
en.output
ggplot(en.output, aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = color) +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output %>%
arrange(source, desc(Log10PValue)) %>%
dplyr::slice(1:10) %>%
ggplot(aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
library(dplyr)
en.output %>%
arrange(source, desc(Log10PValue)) %>%
dplyr::slice(1:10) %>%
ggplot(aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
head(en.output)
en.output %>%
arrange(desc(Log10PValue)) %>%
dplyr::slice(1:10) %>%
ggplot(aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output
arrange(en.output, desc(Log10PValue))
en.output <- arrange(en.output, desc(Log10PValue))
ggplot(en.output, aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output
ggplot(en.output, aes(Tissue, Log10PValue)) + geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output
order(en.output$Log10PValue )
en.output$Log10PValue[order(en.output$Log10PValue)]
en.output$Log10PValue[order(en.output$Log10PValue, decreasing = TRUE)]
ggplot(en.output, aes(Tissue, reorder(Tissue, -Log10PValue))) +
geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(Tissue, reorder(-Log10PValue))) +
geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, -Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(
vjust = 1,
hjust = 1,
size = 12
),
axis.text.y = element_text(size = 12),
plot.margin = margin(10, 10, 10, 100),
legend.position = "none",
plot.title = element_text(color = "black",
size = 18,
face = "bold.italic"),
axis.title.y = element_blank(),
axis.line.x = element_line(
colour = 'black',
size = 0.5,
linetype = 'solid'
),
axis.ticks.x = element_line(
colour = 'black',
size = 1,
linetype = 'solid'
),
axis.title.x = element_text(color = "black",
size = 14,
face = "bold")
)  +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
source("assets/theme_clean.R")
source("/assets/theme_clean.R")
getwd()
source("../assets/theme_clean.R")
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_minimal()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_clean() + coord_flip()
source("../assets/theme_clean.R")
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_clean() + coord_flip()
source("../assets/theme_clean.R")
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_clean() + coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_clean() +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_clean() + xlab("- log10 adj. p-value") + ylab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue)) +
geom_bar(stat = 'identity', fill = "red") +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output <- mutate(en.output, significance = ifelse(Log10PValue > logp, "colored", "nocolor"))
logp <- -log10(0.05)
en.output <- mutate(en.output, significance = ifelse(Log10PValue > logp, "colored", "nocolor"))
en.output
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue), fill = significance) +
geom_bar(stat = 'identity', fill = significance) +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue), color = significance) +
geom_bar(stat = 'identity', fill = significance) +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue, fill = significance)) +
geom_bar(stat = 'identity', fill = significance) +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
en.output
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue, color = significance)) +
geom_bar(stat = 'identity', fill = significance) +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue, color = significance)) +
geom_bar(stat = 'identity') +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue, fill = significance)) +
geom_bar(stat = 'identity') +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_y_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks()) +
coord_flip()
ggplot(en.output, aes(reorder(Tissue, Log10PValue), Log10PValue, fill = significance)) +
geom_bar(stat = 'identity') +
theme_clean() + ylab("- log10 adj. p-value") + xlab("") +
scale_fill_manual(values = c("colored"= "red", "nocolor" = "gray")) +
scale_y_continuous(expand = expansion(mult = c(0, .1)),
breaks = scales::pretty_breaks()) +
coord_flip()
names(gene.lsts)
gene.lsts$DE_up_diff_targetGenes
names(gene.lsts)
